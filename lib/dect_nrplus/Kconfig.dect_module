# /* lib/dect_nrplus/Kconfig.dect_module */
# // Overview: Restructures the entire file to source layer Kconfigs first, resolving dependency order issues. It also moves the logging menu outside the main if-block to make it available for test builds.
#
# Copyright (c) 2023 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

menuconfig DECT_NRPLUS_STACK
	bool "DECT NR+ Protocol Stack Library"
	select PM_DEVICE
	select PRINTK
	select POLL
	select CBPRINTF_FP_SUPPORT
	help
	  Enable the full DECT NR+ protocol stack, including the MAC, DLC,
	  and CVG layers. This is typically selected automatically by a
	  higher-level component, such as the DECT NR+ radio driver.

if DECT_NRPLUS_STACK

config DECT_APP_MAIN_LOG_LEVEL
	int "Log level for the main application"
	default 3
	range 0 4
	depends on LOG
	help
	  Log level for the main application logic contained in
	  dect_mac_main.c. This is separate from the log levels of the
	  individual stack modules.
	  0=off, 1=error, 2=warning, 3=info, 4=debug.

config DECT_APP_TX_INTERVAL_S
	int "Application test TX interval (seconds)"
	default 10
	help
	  The interval, in seconds, at which the example application logic
	  in dect_mac_main.c will attempt to send a burst of test packets.

endif # DECT_NRPLUS_STACK

# This menu is defined outside the main if-block so that test configurations
# (where DECT_NRPLUS_STACK=n) can still see and set these log levels.
menu "DECT NR+ Stack Logging Levels"
	depends on LOG && (DECT_NRPLUS_STACK || ZTEST)

	# --- L2 Driver Log Level ---
	config DECT_NRPLUS_LOG_LEVEL
		int "L2 Driver Log Level"
		default 3
		range 0 4
		help
		  Log level for the DECT NR+ L2 network driver.
		  0=off, 1=error, 2=warning, 3=info, 4=debug.

	# --- Convergence (CVG) Layer Log Level ---
	config DECT_CVG_LOG_LEVEL
		int "CVG Layer Log Level"
		default 3
		range 0 4
		help
		  Log level for the DECT NR+ Convergence (CVG) layer.

	# --- Data Link Control (DLC) Layer Log Level ---
	config DECT_DLC_LOG_LEVEL
		int "DLC Layer Log Level"
		default 3
		range 0 4
		help
		  Log level for the DECT NR+ Data Link Control (DLC) layer.

	# --- Configuration Data Distribution (CDD) Service Log Level ---
	config DECT_CDD_LOG_LEVEL
		int "CDD Service Log Level"
		default 3
		range 0 4
		help
		  Log level for the Configuration Data Distribution (CDD) service.

	# --- MAC Layer Submodule Log Levels ---
	menu "MAC Layer Submodule Logging"
		depends on DECT_MAC_LAYER

		config DECT_MAC_API_LOG_LEVEL
			int "Log level for MAC API"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC API module.

		config DECT_MAC_CORE_LOG_LEVEL
			int "Log level for MAC Core"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC Core module.

		config DECT_MAC_DATA_PATH_LOG_LEVEL
			int "Log level for MAC Data Path"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC Data Path module.

		config DECT_MAC_DISPATCHER_LOG_LEVEL
			int "Log level for MAC Main Dispatcher"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC Main Dispatcher module.

		config DECT_MAC_MGMT_LOG_LEVEL
			int "Log level for MAC Management Service"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC Management Service module.

		config DECT_MAC_NVS_LOG_LEVEL
			int "Log level for MAC NVS"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC NVS module.

		config DECT_MAC_PDU_LOG_LEVEL
			int "Log level for MAC PDU (De)serializers"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC PDU module.

		config DECT_MAC_PHY_CTRL_LOG_LEVEL
			int "Log level for MAC PHY Control"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC PHY Control module.

		config DECT_MAC_PHY_IF_LOG_LEVEL
			int "Log level for MAC PHY Interface"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC PHY Interface module.

		config DECT_MAC_SECURITY_LOG_LEVEL
			int "Log level for MAC Security"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC Security module.

		config DECT_MAC_SM_FT_LOG_LEVEL
			int "Log level for MAC FT State Machine"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC FT State Machine module.

		config DECT_MAC_SM_PT_LOG_LEVEL
			int "Log level for MAC PT State Machine"
			default 3
			range 0 4
			help
			  Log level for the DECT MAC PT State Machine module.

		config DECT_MAC_SHELL_LOG_LEVEL
			int "Log level for MAC Shell"
			default 3
			range 0 4
			depends on DECT_MAC_SHELL_ENABLE
			help
			  Log level for the DECT MAC Shell module.

	endmenu # MAC Layer Submodule Logging

endmenu # DECT NR+ Stack Logging Levels


# Source the Kconfig files for each layer of the stack first.
# This ensures their main symbols (e.g., DECT_MAC_LAYER) are defined
# before being used as dependencies in menus below.

source "../nrf/lib/dect_nrplus/Kconfig.dect_mac"
source "../nrf/lib/dect_nrplus/Kconfig.dect_dlc"
source "../nrf/lib/dect_nrplus/Kconfig.dect_cvg"
source "../nrf/lib/dect_nrplus/Kconfig.dect_cdd"
source "../nrf/lib/dect_nrplus/Kconfig.dect_security"
source "../nrf/drivers/net/dect_nrplus/Kconfig.dect_nrplus"
